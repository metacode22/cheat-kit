[해외주식] 주문/계좌


카테고리 다운로드
REST
해외주식 주문[v1_해외주식-001]

호출테스트

개별문서 다운로드
해외주식 주문[v1_해외주식-001]정보 Method, URL, 실전 Domain, 모의 Domain, Format, Content-Type
Method	POST	URL	/uapi/overseas-stock/v1/trading/order
실전 Domain	https://openapi.koreainvestment.com:9443	모의 Domain	https://openapivts.koreainvestment.com:29443
실전 TR ID	(미국매수) TTTT1002U (미국매도) TTTT1006U (아시아 국가 하단 규격서 참고)	모의 TR ID	(미국매수) VTTT1002U (미국매도) VTTT1001U (아시아 국가 하단 규격서 참고)
Format	JSON	Content-Type	application/json; charset=UTF-8
개요
해외주식 주문 API입니다.

* 모의투자의 경우, 모든 해외 종목 매매가 지원되지 않습니다. 일부 종목만 매매 가능한 점 유의 부탁드립니다.

* 해외주식 서비스 신청 후 이용 가능합니다. (아래 링크 3번 해외증권 거래신청 참고)
https://securities.koreainvestment.com/main/bond/research/_static/TF03ca010001.jsp

* 해외 거래소 운영시간 외 API 호출 시 에러가 발생하오니 운영시간을 확인해주세요.
* 해외 거래소 운영시간(한국시간 기준)
1) 미국 : 23:30 ~ 06:00 (썸머타임 적용 시 22:30 ~ 05:00) 
   * 프리마켓(18:00 ~ 23:30, Summer Time : 17:00 ~ 22:30), 애프터마켓(06:00 ~ 07:00, Summer Time : 05:00 ~ 07:00) 시간대에도 주문 가능
2) 일본 : (오전) 09:00 ~ 11:30, (오후) 12:30 ~ 15:00
3) 상해 : 10:30 ~ 16:00
4) 홍콩 : (오전) 10:30 ~ 13:00, (오후) 14:00 ~ 17:00


※ POST API의 경우 BODY값의 key값들을 대문자로 작성하셔야 합니다.
   (EX. "CANO" : "12345678", "ACNT_PRDT_CD": "01",...)

※ 종목코드 마스터파일 파이썬 정제코드는 한국투자증권 Github 참고 부탁드립니다.
   https://github.com/koreainvestment/open-trading-api/tree/main/stocks_info
요청
Header
주식주문(현금[V1_국내주식-001]) 정보 Element, 한글명, Type, Rquired, Length, Description
Element	한글명	Type	Required	Length	Description
content-type	컨텐츠타입	String	N	40	application/json; charset=utf-8
authorization	접근토큰	String	Y	350	OAuth 토큰이 필요한 API 경우 발급한 Access token
일반고객(Access token 유효기간 1일, OAuth 2.0의 Client Credentials Grant 절차를 준용)
법인(Access token 유효기간 3개월, Refresh token 유효기간 1년, OAuth 2.0의 Authorization Code Grant 절차를 준용)

※ 토큰 지정시 토큰 타입("Bearer") 지정 필요. 즉, 발급받은 접근토큰 앞에 앞에 "Bearer" 붙여서 호출
EX) "Bearer eyJ..........8GA"
appkey	앱키	String	Y	36	한국투자증권 홈페이지에서 발급받은 appkey (절대 노출되지 않도록 주의해주세요.)
appsecret	앱시크릿키	String	Y	180	한국투자증권 홈페이지에서 발급받은 appsecret (절대 노출되지 않도록 주의해주세요.)
personalseckey	고객식별키	String	N	180	[법인 필수] 제휴사 회원 관리를 위한 고객식별키
tr_id	거래ID	String	Y	13	[실전투자]
TTTT1002U : 미국 매수 주문
TTTT1006U : 미국 매도 주문
TTTS0308U : 일본 매수 주문
TTTS0307U : 일본 매도 주문
TTTS0202U : 상해 매수 주문
TTTS1005U : 상해 매도 주문
TTTS1002U : 홍콩 매수 주문
TTTS1001U : 홍콩 매도 주문
TTTS0305U : 심천 매수 주문
TTTS0304U : 심천 매도 주문
TTTS0311U : 베트남 매수 주문
TTTS0310U : 베트남 매도 주문

[모의투자]
VTTT1002U : 미국 매수 주문
VTTT1001U : 미국 매도 주문
VTTS0308U : 일본 매수 주문
VTTS0307U : 일본 매도 주문
VTTS0202U : 상해 매수 주문
VTTS1005U : 상해 매도 주문
VTTS1002U : 홍콩 매수 주문
VTTS1001U : 홍콩 매도 주문
VTTS0305U : 심천 매수 주문
VTTS0304U : 심천 매도 주문
VTTS0311U : 베트남 매수 주문
VTTS0310U : 베트남 매도 주문
tr_cont	연속 거래 여부	String	N	1	tr_cont를 이용한 다음조회 불가 API
custtype	고객타입	String	N	1	B : 법인
P : 개인
seq_no	일련번호	String	N	2	[법인 필수] 001
mac_address	맥주소	String	N	12	법인고객 혹은 개인고객의 Mac address 값
phone_number	핸드폰번호	String	N	12	[법인 필수] 제휴사APP을 사용하는 경우 사용자(회원) 핸드폰번호
ex) 01011112222 (하이픈 등 구분값 제거)
ip_addr	접속 단말 공인 IP	String	N	12	[법인 필수] 사용자(회원)의 IP Address
hashkey	해쉬키	String	N	256	※ 필수 아님 (기존 필수 사항으로 옵션으로 유지)

[POST API 대상] Client가 요청하는 Request Body를 hashkey api로 생성한 Hash값
* API문서 > hashkey 참조
gt_uid	Global UID	String	N	32	[법인 전용] 거래고유번호로 사용하므로 거래별로 UNIQUE해야 함
Body
주식주문(현금[V1_국내주식-001]) 정보 Element, 한글명, Type, Rquired, Length, Description
Element	한글명	Type	Required	Length	Description
CANO	종합계좌번호	String	Y	8	계좌번호 체계(8-2)의 앞 8자리
ACNT_PRDT_CD	계좌상품코드	String	Y	2	계좌번호 체계(8-2)의 뒤 2자리
OVRS_EXCG_CD	해외거래소코드	String	Y	4	NASD : 나스닥
NYSE : 뉴욕
AMEX : 아멕스
SEHK : 홍콩
SHAA : 중국상해
SZAA : 중국심천
TKSE : 일본
HASE : 베트남 하노이
VNSE : 베트남 호치민
PDNO	상품번호	String	Y	12	종목코드
ORD_QTY	주문수량	String	Y	10	주문수량 (해외거래소 별 최소 주문수량 및 주문단위 확인 필요)
OVRS_ORD_UNPR	해외주문단가	String	Y	31	1주당 가격
* 시장가의 경우 1주당 가격을 공란으로 비우지 않음 "0"으로 입력
CTAC_TLNO	연락전화번호	String	N	20	
MGCO_APTM_ODNO	운용사지정주문번호	String	N	12	
SLL_TYPE	판매유형	String	N	2	제거 : 매수
00 : 매도
ORD_SVR_DVSN_CD	주문서버구분코드	String	Y	1	"0"(Default)
ORD_DVSN	주문구분	String	Y	2	[Header tr_id TTTT1002U(미국 매수 주문)]
00 : 지정가
32 : LOO(장개시지정가)
34 : LOC(장마감지정가)
35 : TWAP (시간가중평균)
36 : VWAP (거래량가중평균)
* 모의투자 VTTT1002U(미국 매수 주문)로는 00:지정가만 가능
* TWAP, VWAP 주문은 분할시간 주문 입력 필수

[Header tr_id TTTT1006U(미국 매도 주문)]
00 : 지정가
31 : MOO(장개시시장가)
32 : LOO(장개시지정가)
33 : MOC(장마감시장가)
34 : LOC(장마감지정가)
35 : TWAP (시간가중평균)
36 : VWAP (거래량가중평균)
* 모의투자 VTTT1006U(미국 매도 주문)로는 00:지정가만 가능
* TWAP, VWAP 주문은 분할시간 주문 입력 필수

[Header tr_id TTTS1001U(홍콩 매도 주문)]
00 : 지정가
50 : 단주지정가
* 모의투자 VTTS1001U(홍콩 매도 주문)로는 00:지정가만 가능

[그외 tr_id]
제거

※ TWAP, VWAP 주문은 정정 불가
START_TIME	시작시간	String	N	6	※ TWAP, VWAP 주문유형이고 알고리즘주문시간구분코드가 00일때 사용
※ YYMMDD 형태로 입력
※ 시간 입력 시 정규장 종료 5분전까지 입력 가능
END_TIME	종료시간	String	N	6	※ TWAP, VWAP 주문유형이고 알고리즘주문시간구분코드가 00일때 사용
※ YYMMDD 형태로 입력
※ 시간 입력 시 정규장 종료 5분전까지 입력 가능
ALGO_ORD_TMD_DVSN_CD	알고리즘주문시간구분코드	String	N	2	00 : 분할주문 시간 직접입력 , 02 : 정규장 종료시까지
응답
Header
주식주문(현금[V1_국내주식-001]) 정보 Element, 한글명, Type, Rquired, Length, Description
Element	한글명	Type	Required	Length	Description
content-type	컨텐츠타입	String	Y	40	application/json; charset=utf-8
Body
주식주문(현금[V1_국내주식-001]) 정보 Element, 한글명, Type, Rquired, Length, Description
Element	한글명	Type	Required	Length	Description
rt_cd	성공 실패 여부	String	Y	1	0 : 성공
0 이외의 값 : 실패
msg_cd	응답코드	String	Y	8	응답코드
msg1	응답메세지	String	Y	80	응답메세지
output	응답상세	Object	Y	-	
KRX_FWDG_ORD_ORGNO

한국거래소전송주문조직번호	String	Y	5	주문시 한국투자증권 시스템에서 지정된 영업점코드
ODNO

주문번호	String	Y	10	주문시 한국투자증권 시스템에서 채번된 주문번호
ORD_TMD

주문시각	String	Y	6	주문시각(시분초HHMMSS)
예시
Request
Data Class (Python)
Data Class (Python)
from dataclasses import dataclass

@dataclass
class RequestHeader:
    content-type: Optional[str] = None    #컨텐츠타입
    authorization: str    #접근토큰
    appkey: str    #앱키 
    appsecret: str    #앱시크릿키
    personalseckey: Optional[str] = None    #고객식별키
    tr_id: str    #거래ID
    tr_cont: Optional[str] = None    #연속 거래 여부
    custtype: Optional[str] = None    #고객타입
    seq_no: Optional[str] = None    #일련번호
    mac_address: Optional[str] = None    #맥주소
    phone_number: Optional[str] = None    #핸드폰번호
    ip_addr: Optional[str] = None    #접속 단말 공인 IP
    hashkey: Optional[str] = None    #해쉬키
    gt_uid: Optional[str] = None    #Global UID

@dataclass
class RequestBody:
    CANO: str    #종합계좌번호
    ACNT_PRDT_CD: str    #계좌상품코드
    OVRS_EXCG_CD: str    #해외거래소코드
    PDNO: str    #상품번호
    ORD_QTY: str    #주문수량
    OVRS_ORD_UNPR: str    #해외주문단가
    CTAC_TLNO: Optional[str] = None    #연락전화번호
    MGCO_APTM_ODNO: Optional[str] = None    #운용사지정주문번호
    SLL_TYPE: Optional[str] = None    #판매유형
    ORD_SVR_DVSN_CD: str    #주문서버구분코드
    ORD_DVSN: str    #주문구분
    START_TIME: Optional[str] = None    #시작시간
    END_TIME: Optional[str] = None    #종료시간
    ALGO_ORD_TMD_DVSN_CD: Optional[str] = None    #알고리즘주문시간구분코드

복사하기
Response
Data Class (Python)
Data Class (Python)
from dataclasses import dataclass
from typing import List, Optional

@dataclass
class ResponseHeader:
    content-type: str    #컨텐츠타입

@dataclass
class ResponseBody:
    rt_cd: str    #성공 실패 여부
    msg_cd: str    #응답코드
    msg1: str    #응답메세지
    output: ResponseBodyoutput    #응답상세

@dataclass
class ResponseBodyoutput:
    KRX_FWDG_ORD_ORGNO: str    #한국거래소전송주문조직번호
    ODNO: str    #주문번호
    ORD_TMD: str    #주문시각
